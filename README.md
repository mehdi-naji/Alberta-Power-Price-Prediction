[![pages-build-deployment](https://github.com/slalom-ubc-mds/Power-Price-Prediction/actions/workflows/pages/pages-build-deployment/badge.svg)](https://github.com/slalom-ubc-mds/Power-Price-Prediction/actions/workflows/pages/pages-build-deployment)

# Power-Price-Prediction

Welcome to our Power Price Prediction project, a comprehensive and explainable solution for predicting energy prices in the Alberta Energy Market. We leverage data science to deliver forecasts, empowering organizations to optimize their energy procurement strategies.

Explore our [Sample Tableau Dashboard](https://public.tableau.com/app/profile/gaoxiang.wang8077/viz/AESOVersion6_0/PredictedDash?publish=yes) for a live demonstration.

Dive into the sections below to discover more about our project:

- [Team](#team)
- [Project Overview](#project-overview)
- [Dashboard Features](#dashboard-features)
- [Installation](#installation)
- [Usage](#usage)

## Team

Our team comprises Masters of Data Science students at the University of British Columbia, in collaboration with [Slalom Consulting, LLC](https://www.slalom.com/).

- [Arjun Radhakrishnan](https://github.com/rkrishnan-arjun)
- [Sneha Sunil](https://github.com/snesunil)
- [Gaoxiang Wang](https://github.com/louiewang820)
- [Mehdi Naji](https://github.com/mehdi-naji)

## Project Overview

Driven by the need for reliable long-term energy forecasts in the deregulated Alberta Energy Market, our project delivers 12-hour ahead hourly energy price predictions. Our model aims to help businesses optimize their energy procurement strategy by providing insights into energy costs and enabling exploration of alternatives like sourcing from different suppliers, purchasing at different times, or even considering own energy generation systems.

## Dashboard Features

Our dashboard provides an intuitive, real-time representation of energy price predictions, underpinned by a comprehensive breakdown of influencing factors.

- **Time Series Chart and Confidence Interval:** 24-hour time series chart with past and future energy prices, including a 95% confidence interval for predictions.
- **Interactive Features & Tool-Tips:** Enhanced user interaction with tool-tips providing specific data points on hover.
- **Interactive Bar Chart & Explanatory Text:** Deeper insights into the model's predictions with accompanying explanatory text highlighting key influencing factors.
- **Prediction Influences & Contextual Information:** Detailed breakdown of influencing factors for predictions, with contextual plots of key price influencers. To provide additional context, the dashboard breaks down the influences that affect our predictions. We quantify the contribution of each feature in relation to the average power price for the previous year, which serves as the base value. Significant factors such as the gas supply mix, total reserve margin, and weekly profile are identified as key influencers. Furthermore, we have discovered four global key influencing factors strongly correlated with the price: the proportion of total energy generated by gas and wind, as well as the available reserves of each to meet surges in demand. Time series plots of these features are included in the bottom right section of the dashboard, offering users valuable insights into their impact on the predicted energy prices. Users can also choose to hide/unhide the contexutal explaintions for simplicity.

## Installation

Ensure you have the following tools installed:

- [Tableau](https://www.tableau.com/)
- [Databricks Tableau driver](https://www.databricks.com/spark/odbc-drivers-download?_gl=1*wbycmt*_gcl_au*MTExNDA4MjAzOC4xNjg1Mzg0MjQw&_ga=2.190062569.311368728.1687321881-777036860.1685384240)
- [VS Code](https://code.visualstudio.com/)

## Usage

### Local Setup

Follow the instructions below to run the prediction pipeline locally.

1. Clone the repo:

```bash
git clone https://github.com/slalom-ubc-mds/Power-Price-Prediction.git
```

2. Navigate to the project:

```bash
cd Power-Price-Prediction
```

3. Install and activate the required environment:

```bash
conda env create --file environment.yml
conda activate power_price_pred
```

4. Run the prediction pipeline using Makefile. Note that the entire pipeline takes approximately 3+ hours to run on an Intel i7 12700H, 14 Cores, 16 GB RAM. The original model is trained using data from January 1st, 2021 to January 31st, 2023. Therefore, please keep the following in mind when setting up your training parameters:

    - `MODEL_TRAIN_START_DATE`: This parameter should be set to a date later than January 1st, 2021 and earlier than December 31st, 2022. This is to ensure the model has at least one month's worth of training data.

    - `PREDICT_UNTIL`: This is the date up to which you want to generate predictions. It should be set to a date later than February 1st, 2023 and earlier than May 30th, 2023.

    - `N_ESTIMATORS`: This parameter denotes the number of boosting stages the model will go through. You can tweak this number to balance model performance and training time according to your requirements.

    - `DEVICE`: Specify the hardware you want to use for training the model. If your system supports GPU processing, set this to 'gpu' for faster training. If not, or if you prefer to use the CPU, the default value is 'cpu'.

```bash
make MODEL_TRAIN_START_DATE=2021-01-01 PREDICT_UNTIL=2023-02-28 N_ESTIMATORS=1000 DEVICE=cpu
```

> You can limit the training data and number of estimators for a quicker (~5 minutes) test run.

```bash
make MODEL_TRAIN_START_DATE=2022-12-01 PREDICT_UNTIL=2023-02-05 N_ESTIMATORS=1 DEVICE=cpu
```

### Deployment to Databricks

To deploy the prediction pipeline to Databricks, follow the instructions below:

1. Publish scripts in [src/databricks_prediction_pipeline](https://github.com/slalom-ubc-mds/Power-Price-Prediction/tree/main/src/databricks_prediction_pipeline) on Databricks cluster with [SKTIME](https://www.sktime.net/en/latest/installation.html) and [LightGBM](https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html) installed.
2. Run [prediction_pipeline.ipynb](https://github.com/slalom-ubc-mds/Power-Price-Prediction/blob/main/src/databricks_prediction_pipeline/prediction_pipeline.ipynb) to train the model and generate the initial set of predictions.
3. Schedule [update_predict_pipeline.ipynb](https://github.com/slalom-ubc-mds/Power-Price-Prediction/blob/main/src/databricks_prediction_pipeline/update_predict_pipeline.ipynb) as a Databricks job to update predictions at your preferred frequency.

To configure Tableau for local or Databricks data source, refer to these guides:

- [Local Tableau Configuration](https://github.com/slalom-ubc-mds/Power-Price-Prediction/blob/main/Tableau_ReadME.md#connect-tableau-with-local-files)
- [Databricks Tableau Configuration](https://github.com/slalom-ubc-mds/Power-Price-Prediction/blob/main/Tableau_ReadME.md#connect-tableau-with-databricks)
